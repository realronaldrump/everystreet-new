{% extends "base.html" %} {% block title %}Driving Navigation{% endblock %} {%
block head_content %}

<!-- Mapbox GL CSS -->
<link rel="stylesheet" href="{{ CDN.mapbox_gl_css }}" />
<link
  rel="stylesheet"
  href="{{ url_for('static', path='css/driving_navigation.css') | replace('http://', '//') }}"
/>

{% endblock %} {% block content %}
<div class="main-container">
  <div class="control-panel">
    <h4 class="mb-3"><i class="fas fa-route"></i> Driving Navigation</h4>

    <div class="control-section">
      <label for="area-select" class="form-label">Coverage Area</label>
      <select
        id="area-select"
        class="form-select bg-dark text-white border-secondary"
      >
        <option value="">Select an area...</option>
      </select>
    </div>

    <div class="control-section">
      <h5 class="h6">Actions</h5>
      <div class="d-grid gap-2">
        <button id="find-next-street-btn" class="btn btn-primary" disabled>
          <i class="fas fa-route"></i> Find Nearest Undriven Street
        </button>
        <button
          id="calculate-coverage-route-btn"
          class="btn btn-success"
          disabled
        >
          <i class="fas fa-road-spikes"></i> Calculate Full Coverage Route
        </button>
        <button id="find-efficient-street-btn" class="btn btn-info" disabled>
          <i class="fas fa-layer-group"></i> Find Efficient Clusters
        </button>
      </div>
    </div>

    <div class="control-section">
      <h5 class="h6">Export Coverage Route</h5>
      <div class="input-group">
        <select
          id="coverage-route-format-select"
          class="form-select bg-dark text-white border-secondary"
        >
          <option value="geojson">GeoJSON</option>
          <option value="gpx">GPX</option>
          <option value="shapefile">Shapefile (Zip)</option>
        </select>
        <button
          id="export-coverage-route-btn"
          class="btn btn-outline-secondary"
          disabled
        >
          <i class="fas fa-download"></i> Export
        </button>
      </div>
    </div>

    <div class="control-section mt-auto">
      <div class="form-check form-switch">
        <input
          class="form-check-input"
          type="checkbox"
          role="switch"
          id="auto-follow-toggle"
        />
        <label class="form-check-label" for="auto-follow-toggle"
          >Auto-Follow Current Location</label
        >
      </div>
    </div>

    <div id="status-message" class="text-info">
      <i class="fas fa-info-circle"></i> Please select an area to begin.
    </div>

    <div id="target-info"></div>

    <div id="route-info" class="control-section">
      <h6 class="mb-2"><i class="fas fa-route me-2"></i>Route Information</h6>
      <div id="route-details-content"></div>
      <div class="mt-3">
        <div class="btn-group w-100">
          <button
            id="open-google-maps-btn"
            class="btn btn-outline-light"
            disabled
          >
            <i class="fab fa-google me-2"></i>Open in Google Maps
          </button>
          <button
            id="open-apple-maps-btn"
            class="btn btn-outline-light"
            disabled
          >
            <i class="fab fa-apple me-2"></i>Open in Apple Maps
          </button>
        </div>
      </div>
    </div>

    <div id="route-progress-container">
      <div class="progress-steps">
        <div id="step-clustering" class="step">Clustering</div>
        <div id="step-optimizing" class="step">Optimizing</div>
        <div id="step-rendering" class="step">Rendering</div>
      </div>
      <div class="progress">
        <div
          id="route-progress-bar"
          class="progress-bar progress-bar-striped progress-bar-animated"
          role="progressbar"
          style="width: 0%"
        ></div>
      </div>
      <div id="processing-status" class="text-muted">Preparing...</div>
    </div>

    <div id="route-details">
      <h5 class="h6">Route Details</h5>
      <div id="route-stats"></div>
      <h6 class="mt-3">Legend</h6>
      <div id="route-legend"></div>
    </div>
  </div>

  <div class="map-container">
    <div id="driving-map"></div>
  </div>
</div>
{% endblock %} {% block extra_js %}

<!-- Mapbox GL JS -->
<script src="{{ CDN.mapbox_gl_js }}"></script>
<script src="{{ url_for('static', path='js/map-base.js') | replace('http://', '//') }}"></script>
<script src="{{ url_for('static', path='js/modules/map-styles.js') | replace('http://', '//') }}"></script>
<script>
  window.MAPBOX_ACCESS_TOKEN = "{{ MAPBOX_ACCESS_TOKEN }}";
</script>

<script src="{{ url_for('static', path='js/driving-navigation.js') | replace('http://', '//') }}"></script>
{% endblock %}
