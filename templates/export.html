{% extends "base.html" %}

{% block title %}
Every Street - Export Data
{% endblock %}


{% block extra_css %}
  <link rel="stylesheet"
        href="{{ url_for('static', path='css/export.css') | replace('http://', '//') }}?v={{ repo_version.commit_count }}" />
{% endblock %}



{% block content %}

  <div class="export-page">
    <div class="bento-grid" data-stagger>
      <div class="bento-span-12 widget" data-accent="mint">
        <div class="widget-header">
          <div>
            <h1 class="widget-title">
              <i class="fas fa-file-export" aria-hidden="true"></i>
              Export Data
            </h1>
            <div class="widget-meta">
              Download your trips and coverage data
            </div>
          </div>
        </div>
      </div>

      <div class="bento-span-8 widget" data-accent="purple">
        <div class="widget-body">
          <form id="export-form">
            <div class="export-category">
              <button type="button" class="export-category-header" aria-expanded="true" data-target="trips-section">
                <div class="export-category-title">
                  <i class="fas fa-car"></i>
                  <span>Trip Data</span>
                </div>
                <i class="fas fa-chevron-down export-category-chevron"></i>
              </button>
              <div class="export-category-body" id="trips-section">
                <p class="export-category-desc">
                  Export your driving trips with optional map-matched geometry.
                </p>
                
                <div class="export-quick-select">
                  <label class="export-quick-option">
                    <input type="checkbox" id="export-trips" checked />
                    <span class="export-quick-option-content">
                      <i class="fas fa-car"></i>
                      <span>Trips</span>
                    </span>
                  </label>
                  <label class="export-quick-option">
                    <input type="checkbox" id="export-matched-trips" />
                    <span class="export-quick-option-content">
                      <i class="fas fa-map-marked-alt"></i>
                      <span>Matched Trips</span>
                    </span>
                  </label>
                </div>

                <div class="export-subsection">
                  <div class="export-subsection-header">
                    <span>Format</span>
                  </div>
                  <select class="export-format-select" id="trip-format">
                    <option value="json">JSON</option>
                    <option value="csv">CSV (Spreadsheet)</option>
                    <option value="geojson">GeoJSON (Map Data)</option>
                    <option value="gpx">GPX (GPS Device)</option>
                  </select>
                </div>

                <div class="export-subsection">
                  <div class="export-subsection-header">
                    <span>Options</span>
                  </div>
                  <label class="export-simple-toggle">
                    <span>Include coordinates</span>
                    <input class="form-check-input" type="checkbox" id="include-trip-geometry" checked />
                  </label>
                </div>

                <div class="export-subsection export-subsection-filters">
                  <div class="export-subsection-header">
                    <span>Filters</span>
                    <span class="export-subsection-hint">Optional</span>
                  </div>
                  <div class="export-filters-compact">
                    <div class="export-filter-field">
                      <label for="trip-start-date">From</label>
                      <input type="date" class="export-filter-input" id="trip-start-date" />
                    </div>
                    <div class="export-filter-field">
                      <label for="trip-end-date">To</label>
                      <input type="date" class="export-filter-input" id="trip-end-date" />
                    </div>
                    <div class="export-filter-field">
                      <label for="trip-status">Status</label>
                      <select class="export-filter-input" id="trip-status">
                        <option value="">All</option>
                        <option value="processed">Processed</option>
                        <option value="completed">Completed</option>
                        <option value="active">Active</option>
                      </select>
                    </div>
                    <div class="export-filter-field">
                      <label for="trip-vehicle">Vehicle</label>
                      <select class="export-filter-input" id="trip-vehicle">
                        <option value="">Any vehicle</option>
                      </select>
                    </div>
                  </div>
                  <div class="export-filter-toggles">
                    <label class="export-simple-toggle export-simple-toggle-small">
                      <span>All time</span>
                      <input class="form-check-input" type="checkbox" id="trip-all-time" />
                    </label>
                    <label class="export-simple-toggle export-simple-toggle-small">
                      <span>Include invalid</span>
                      <input class="form-check-input" type="checkbox" id="trip-include-invalid" />
                    </label>
                  </div>
                </div>
              </div>
            </div>

            <div class="export-category">
              <button type="button" class="export-category-header" aria-expanded="false" data-target="coverage-section">
                <div class="export-category-title">
                  <i class="fas fa-map"></i>
                  <span>Coverage Data</span>
                </div>
                <i class="fas fa-chevron-down export-category-chevron"></i>
              </button>
              <div class="export-category-body collapsed" id="coverage-section">
                <p class="export-category-desc">
                  Export street coverage data for your defined areas.
                </p>
                
                <div class="export-quick-select">
                  <label class="export-quick-option">
                    <input type="checkbox" id="export-streets" />
                    <span class="export-quick-option-content">
                      <i class="fas fa-road"></i>
                      <span>All Streets</span>
                    </span>
                  </label>
                  <label class="export-quick-option">
                    <input type="checkbox" id="export-boundaries" />
                    <span class="export-quick-option-content">
                      <i class="fas fa-draw-polygon"></i>
                      <span>Boundary</span>
                    </span>
                  </label>
                  <label class="export-quick-option">
                    <input type="checkbox" id="export-undriven" />
                    <span class="export-quick-option-content">
                      <i class="fas fa-route"></i>
                      <span>Undriven</span>
                    </span>
                  </label>
                </div>

                <div class="export-subsection">
                  <div class="export-subsection-header">
                    <span>Coverage Area</span>
                    <span class="export-subsection-hint">Required</span>
                  </div>
                  <select class="export-filter-input" id="coverage-area">
                    <option value="">Select an area...</option>
                  </select>
                </div>

                <div class="export-info-note">
                  <i class="fas fa-info-circle"></i>
                  Coverage exports are in GeoJSON format
                </div>
              </div>
            </div>

            <div class="export-actions">
              <div class="export-error hidden" role="alert" id="export-error">
                <i class="fas fa-exclamation-circle"></i>
                <span id="export-error-text"></span>
              </div>
              <div class="export-actions-buttons">
                <button type="submit" class="export-btn export-btn-primary" id="export-submit">
                  <i class="fas fa-download"></i>
                  Create Export
                </button>
                <button type="button" class="export-btn export-btn-secondary" id="export-reset">
                  Reset
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <div class="bento-span-4 widget" data-accent="sky">
        <div class="widget-header">
          <h2 class="widget-title">
            <i class="fas fa-clipboard-list" aria-hidden="true"></i>
            Summary
          </h2>
        </div>
        <div class="widget-body">
          <div class="export-summary" id="export-summary">
            <div class="export-summary-empty">
              <i class="fas fa-folder-open"></i>
              <p>No items selected</p>
            </div>
            <ul class="export-summary-list hidden" id="export-summary-list">
            </ul>
          </div>

          <div class="export-progress hidden" id="export-progress">
            <div class="export-progress-text" id="export-status-text">Preparing...</div>
            <div class="export-progress-bar-container">
              <div class="export-progress-bar" id="export-progress-bar" style="width: 0%"></div>
            </div>
            <div class="export-progress-percent" id="export-progress-percent">0%</div>
          </div>

          <div class="export-result hidden" id="export-result">
            <div class="export-result-icon">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="export-result-info">
              <div class="export-result-title">Export Ready</div>
              <div class="export-result-details" id="export-result-details"></div>
            </div>
            <a class="export-download-btn" id="export-download" href="#">
              <i class="fas fa-file-archive"></i>
              Download
            </a>
          </div>
        </div>
      </div>

    </div>
  </div>
{% endblock %}
