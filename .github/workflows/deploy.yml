name: Deploy to Mini PC

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: self-hosted
    steps:
      - name: Force Overwrite with Latest Code
        run: |
          cd /home/davis/app
          
          # Get the latest code from GitHub
          git fetch origin main
          
          # WARNING: This will DELETE all local changes.
          # Force the local branch to match the remote branch
          git reset --hard origin/main
          
          # Clean up any new untracked files/folders
          git clean -fd
          
      - name: Deploy Application
        run: |
          cd /home/davis/app
          bash deploy.sh